//ENDSEM

START: LXI H,5000H
LXI SP,FFFFH
MVI C,20H
L1:CALL BCD2HEX
INX H
DCR C
JNZ L1
LXI H,5101H
MVI C,10H
L2:CALL ADDFPNUM
DCR C
JNZ L2
LXI H,6000H
MOV C,M
INX H
MOV B,M
MVI E,04H
L3:MOV A,B
RAR
MOV B,A
MOV A,C
RAR
MOV C,A
ADI 00H
DCR E
JNZ L3
MOV M,B
DCX H
MOV M,C
LXI H,6001H
CALL HEX2BCD
SHLD 6001H //STORING MEAN
CALL SORTFPNUM //SORTING THE GIVEN NUMBERS IN ASCENDING ORDER
LXI H,510FH
MVI E,00H
MOV B,M
INX H
INX H 
MOV A,M
ADD B
JNC GPR
INR E
GPR:MOV B,A
DCX H
MOV D,M
DCX H
DCX H
MOV A,M
ADD D
ADD E
RAR
STA 6011H
MOV A,B
RAR
STA 6010H
LXI H,6011H
CALL HEX2BCD
SHLD 6011H //STORING MEDIAN
LXI H,6000H
CALL HEX2BCDFRAC
LXI H,6010H
CALL HEX2BCDFRAC
HLT

//BCD TO HEXADECIMAL CONVERSION SUBROUTINE
BCD2HEX:PUSH B
MOV A,M
ANI F0H
RRC
MOV B,A
RRC
RRC
ADD B
MOV B,A
MOV A,M
ANI 0FH
ADD B
INR H
MOV M,A
DCR H

INX H
MOV A,M
ANI 0FH
MOV B,A
MOV A,M
ANI F0H
RRC
MOV C,A
RRC
RRC
ADD C
ADD B
MVI B,80H
MVI C,00H
LOOP:RLC 
CPI 64H
JC GOAHEAD
SUI 64H
MOV E,A
MOV A,B
ADD C
MOV C,A
MOV A,B
XRI 01H
JNZ JUMP
MVI B,00H
JUMP:MOV A,B
RRC
JZ HLIT
MOV B,A
MOV A,E
ADI 00H
JZ HLIT
JMP LOOP
GOAHEAD:MOV E,A
MOV A,B
XRI 01H
JNZ JUMP1
MVI B,00H
JUMP1:MOV A,B
RRC
JZ HLIT
MOV B,A
MOV A,E
JMP LOOP
HLIT:INR H
MOV M,C
DCR H
POP B
RET

//SUBROUTINE FOR ADDING FIXED POINT NUMBERS
ADDFPNUM:MVI E,00H
LDA 6000H
MOV B,M
ADD B
JNC SKIP100
INR E
SKIP100:STA 6000H
LDA 6001H
DCX H
MOV B,M
ADD B
ADD E
STA 6001H
INX H
INX H
INX H
RET

//HEXADECIMAL TO BCD CONVERSION SUBROUTINE FOR INTEGER PART
HEX2BCD:
MVI D,00H
MVI B,00H
XRA A
MOV C,M
L25:ADI 01H
DAA
JNC GO50
INR D
GO50:DCR C
JNZ L25
MOV L,A
MOV H,D
RET

// BUBBLE SORT CODE FOR SORTING FIXED POINT NUMBERS
SORTFPNUM:MVI B,0FH
BIGLOOP:MOV C,B
LXI H,5100H
MVI E,00H
GOBACK111:MOV A,M
INX H
INX H
CMP M
JC SKIPSWAP1
JNZ GOAHEAD111
DCX H
MOV A,M
INX H
INX H
CMP M
JC SKIPSWAP
JZ SKIPSWAP
DCX H
GOAHEAD111:MOV B,L
MOV A,M
DCX H
DCX H
MOV D,M
MOV M,A
INX H
INX H
MOV M,D
INX H
MOV A,M
DCX H
DCX H
MOV D,M
MOV M,A
INX H
INX H
MOV M,D
MVI E,01H
SKIPSWAP:DCX H
DCR C
JNZ GOBACK111
MVI A,00H
CMP E
JNZ BIGLOOP 
RET
SKIPSWAP1:
DCR C
JNZ GOBACK111
MVI A,00H
CMP E
JNZ BIGLOOP 
RET

//HEXADECIMAL TO BCD CONVERSION SUBROUTINE FOR FRACTION PAR
HEX2BCDFRAC:
MVI C,08H
MVI B,32H
MVI E,00H
GOPROOF:MOV A,M
RAL
MOV M,A
JNC SKIPTHIS
MOV A,B
ADD E
MOV E,A
SKIPTHIS:MOV A,B
RAR
MOV B,A
ADI 00H
DCR C
JNZ GOPROOF
MOV M,E
MVI D,00H
MVI B,00H
XRA A
MOV C,M
LOOP2501:ADI 01H
DAA
JNC GOAHEAD501
INR D
GOAHEAD501:DCR C
JNZ LOOP2501
MOV M,A
INX H
MOV A,M
ADD D
MOV M,A
RET




#ORG 5000H
#DB 03H,19H,02H,13H,04H,75H,16H,75H,08H,08H,10H,75H,12H,63H,15H,75H,11H,65H,14H,25H,09H,08H,06H,38H,12H,75H,05H,32H,01H,25H,11H,63H